Let us consider the following subset of indexes at $x^k$:

\begin{equation}\label{eq:indexes}
 \begin{aligned}
   L(x^k) =\{ i \in\{1,\ldots,n \}: x^k_i = a_i\}\\
  U(x^k) =\{i \in\{1,\ldots,n \} : x^k_i = b_i\}
 \end{aligned}
\end{equation}
Also we define set:
\begin{equation}
 C(x^k)=\{ i \in\{1,\ldots,n \}: a_i<x^k_i < b_i\}\\
\end{equation}
We use the following lemma:
\begin{lemma}\label{lem:direction}
 Let ${(x^k,y^k)} \in \mathcal{F}$ a sequence converging to $(\overline{x},\overline{y}) \in \mathcal{F}$, then for $k$ sufficiently large we have:
 
 \begin{subequations}
 \begin{align}
& \mathcal{D}(\overline{x},\overline{y}) \subseteq \mathcal{D}(x^k,y^k)\\
&L(\overline{x})\cup C(\overline{x})  \subseteq L(x^k)\cup C(x^k)\\
&U(\overline{x})\cup C(\overline{x})  \subseteq U(x^k)\cup C(x^k)
\end{align}
 \end{subequations}

\end{lemma}

\begin{proposition}
Suppose that the level set $\mathcal{L}_0$ is a compact set. Let $\{(x^k, y^k)\}$ be the sequence of points generated by the decomposition algorithm. Then
\begin{itemize}
\item $(x^k, y^k) \in \mathcal{L}_0, \enskip \forall k$ 
\item  $\{(x^k, y^k)\}$ admits limit points and each limit point is critical for Problem (\ref{eq:problem})
\end{itemize}
\end{proposition}

\begin{proof}
From (\ref{eq:updatey}) we have
\begin{equation}
f(x^{k+1}, y^{k}) \leq f(x^{k}, y^{k})
\end{equation}
and from the update rule of $x$ it follows
\begin{equation}\label{eq:dec}
f(x^{k+1}, y^{k+1}) \leq f(x^{k+1}, y^{k})
\end{equation}
Finally we have
\begin{equation}
f(x^{k+1}, y^{k+1}) \leq f(x^{k}, y^{k})
\end{equation}
so we have that the points of the sequence $\{(x^{k}, y^{k})\}$ belongs to the level set $\mathcal{L}_0$.
\vspace{1.5cm}

Let $(\overline{x},\overline{y})$ be a limit point of $\{(x^k, y^k)\}$, i.e. there exist an infinite subset $K \subseteq N$ such that
\begin{equation}\label{eq:asim}
\lim_{k \in K, k \rightarrow \infty} (x^k, y^k) = (\overline{x},\overline{y}) \qquad \lim_{k \in K, k \rightarrow \infty} d^{i(k),j(k)} = \overline{d}
\end{equation}
By contradiction, let us assume that $(\overline{x},\overline{y})$ is not a solution. In this case, at least one of the following conditions hold:
\begin{subequations}
\begin{align}
&\nabla_y f(\overline{x},\overline{y}) \neq 0  \label{eq:a}\\
&\exists \enskip i, j \enskip  \text{s.t.} \enskip \overline{x}_i > l_i \enskip  \text{and} \enskip  \nabla_x f(\overline{x},\overline{y})^T d^{i,j} = -\eta < 0 \label{eq:b}
\end{align}
\end{subequations}
For Point (\ref{eq:a}), we recall that for (\ref{eq:updatey}) $y^{k+1}$ minimizes $f(x^{k+1},y)$ with respect to $y$. So, if we imagine to perform QLS along a descent direction (for example, $-\nabla_y f(x^{k+1},y^{k})$) we have
\begin{equation}\label{eq:dis}
f(x^{k+1}, y^{k+1}) \leq f(x^{k+1}, y^{k}) - \gamma (\alpha \parallel \nabla_y f(x^{k+1}, y^{k}) \parallel) ^2 \qquad \forall \alpha, \gamma > 0
\end{equation}
From (\ref{eq:dis}) and thanks to (\ref{eq:dec}), we can extend the QLS convergence properties to $(x^{k+1}, y^{k+1})$. In particular, we can write
\begin{equation}
\lim_{k \in K, k \rightarrow \infty} \parallel \nabla_y f(x^{k}, y^{k}) \parallel =  \parallel \nabla_y f(\overline{x},\overline{y}) \parallel = 0
\end{equation}
So we have proved that (\ref{eq:a}) cannot hold.\\
For Point (\ref{eq:b}), the algorithm performs a QLS line search along $d^{i(k),j(k)}$ to determine the step $\alpha^{k}$. Thanks to QLS we can write
\begin{equation}\label{eq:armijoprop}
%\lim_{k \in K, k \rightarrow \infty} \alpha^{k} \parallel d^{i(k),j(k)} \parallel \frac{ \left| \nabla_x f(x^{k}, y^{k+1})^T d^{i(k),j(k)} \right|}{\parallel d^{i(k),j(k)} \parallel} = 0
\lim_{k \in K, k \rightarrow \infty} \alpha^{k} \parallel d^{i(k),j(k)} \parallel = 0
\end{equation}
From (\ref{eq:direction}), we know that $\parallel d^{i(k),j(k)} \parallel = \sqrt{2} \enskip\forall k$, so from (\ref{eq:armijoprop}) it follows
\begin{equation}\label{eq:alpha}%\label{eq:armijoprop2}
%\lim_{k \in K, k \rightarrow \infty} \alpha^{k}  \left| \nabla_x f(x^{k}, y^{k+1})^T d^{i(k),j(k)} \right| = 0
\lim_{k \in K, k \rightarrow \infty} \alpha^{k}=0
\end{equation}
From (\ref{eq:b}) and because of $\overline{d}$ is limit of steepest descent direction of only two nonzero components in $\overline{x}$ we can write
\begin{equation}\label{eq:wrong}
\lim_{k \in K, k \rightarrow \infty} \nabla_x f(x^k, y^k)^T d^{i(k),j(k)} = \nabla_x f(\overline{x},\overline{y})^T \overline{d} = \eta_1 \le \eta < 0
\end{equation}
In general, we have that
\begin{equation}
\lim_{k \in K, k \rightarrow \infty} \alpha^k \leq \lim_{k \in K, k \rightarrow \infty} \Delta^k
\end{equation}
We have to differentiate between two cases:
\begin{subequations}
\begin{align}
& \lim_{k \in K, k \rightarrow \infty} \Delta^k > 0 \label{eq:great}\\
& \lim_{k \in K, k \rightarrow \infty} \Delta^k = 0 \label{eq:zero}
\end{align}
\end{subequations}
If (\ref{eq:great}) holds, for large enough values of $k$, i.e. for $k \geq \hat{k}$, it must be $\alpha^k < \Delta^k$. From QLS properties we have at least a failure, for $k \geq \hat{k}$:
\begin{equation}\label{eq:arm1}
f(x^k + \frac{\alpha^k}{\delta} d^{i(k),j(k)}, y^k) - f(x^k,y^k) > -\gamma \left(\frac{\alpha^k}{\delta}\right)^2 ||d^{i(k),j(k)}||^2
\end{equation}
For the mean value theorem, we can write
\begin{equation}\label{eq:arm2}
f(x^k + \frac{\alpha^k}{\delta} d^{i(k),j(k)}, y^k) = f(x^k, y^k) + \frac{\alpha^k}{\delta} \nabla_x f(z^k, y^k)^T d^{i(k),j(k)}
\end{equation}
where $z^k = x^k + \vartheta_k \frac{\alpha^k}{\delta} d^{i(k),j(k)}$ and $\vartheta_k \in (0,1)$. From (\ref{eq:arm2}) and (\ref{eq:arm1}), for $k \geq \hat{k}$, we have
\begin{equation}\label{eq:nabla}
\nabla_x f(z^k, y^k)^T d^{i(k),j(k)}  >- \gamma \frac{\alpha^k}{\delta} ||d^{i(k),j(k)}||^2
\end{equation}
Using (\ref{eq:asim}) and (\ref{eq:alpha}) it must be
\begin{equation}
\lim_{k \in K, k \rightarrow \infty} z^k = \lim_{k \in K, k \rightarrow \infty} x^k + \vartheta_k \frac{\alpha^k}{\delta} d^{i(k),j(k)} = \overline{x}
\end{equation}
Taking the limit value of each member of (\ref{eq:nabla}) we have
\begin{equation}
\nabla_x f(\overline{x},\overline{y})^T \overline{d} \geq 0 %\gamma \nabla_x f(\overline{x},\overline{y})^T \overline{d}
\end{equation}
which contradicts that $\exists i,j$ such that $\overline{x}_i >l_i$ and:
\begin{equation}
\nabla_x f(\overline{x},\overline{y})^T d^{i,j} =\eta <0
\end{equation}

%that does not hold, since $\gamma < 1$. So we have proved that, if (\ref{eq:great}) holds, (\ref{eq:b}) cannot hold. \\

If (\ref{eq:zero}) holds, we have to remark the subset of indexes defined in \ref{eq:indexes}.

\iffalse
%If (\ref{eq:zero}) holds, we have to define the following subset of indexes, for all iteration $k$:
If (\ref{eq:zero}) holds we recall subset defined in \ref{eq:sets} computed in $x^k$.

In next iterations $k+m$, $m\ge 0$ we have at least one of these two possible cases, from MVP selection rule:
\begin{subequations}
\begin{align}
 j(k+m) &\in L(x^{k+m+1})\label{eq:SetCasesA}\\
 i(k+m) &\in U(x^{k+m+1})\label{eq:SetCasesB}
\end{align}
\end{subequations}

Now we define two sets $\Gamma_1,\Gamma_2$ such that the first one contains all indexes $m \in\{0,\ldots,2n\}$ such that \ref{eq:SetCasesA} hold.
On the contrary the second one contains all indexes $m \in\{0,\ldots,2n\}$ such that \ref{eq:SetCasesB} hold.

Because of $|\Gamma_1|+|\Gamma_2|\ge2n+1$, one of these set have more than $n$ elements. Without loss of generality we take $|\Gamma_1|> n$.

Then there exist at least two indexes $0\le h(k)< m(k)\le 2n$ such that:
\begin{equation}
 i(h(k))=i(m(k))=i^*
\end{equation}

We can define a subset $K \subseteq \{0,1,\ldots\}$ such that $\forall k_i \in K$ holds:
\begin{equation}
 i(k_i)=i^*
\end{equation}
and:
\begin{equation}
 k_i <k_{i+1} \le k_i+2n
\end{equation}

For the MVP selection rule $\forall k_i \in K$ must hold:
\begin{equation}
 \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i^*}} \le \frac{\partial f(x^{k_i},y^{k_i})}{dx_{h}}, \ \forall h \in L(x^{k_i}) \cup C(x^{k_i})
\end{equation}

But  $\forall k_i \in K,\exists p(k_i)$ with  $k_i <p(k_i)<k_{i+1}$ such that:
\begin{equation}
 i^* \not \in U(x^{p(k_i)+1})
\end{equation}
and then
\begin{equation}
 \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{i^*}} \ge \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{h}}, \ \forall h \in U(x^{p(k_i)}) \cup C(x^{p(k_i)})
\end{equation}


Thanks to Lemma (\ref{lem:direction}) we can say that for $k$ sufficiently large, the set of feasible direction in $(x^k,y^k)$ contains the correspondent set in $(\overline{x},\overline{y})$.

Then for $k_i \in K_1 \subset K$, $k_i$ sufficiently large, then following \ref{eq:b} we have:
\begin{equation}
\begin{aligned}
i \in L(x^{k_i},y^{k_i}) \cup C(x^{k_i},y^{k_i})\\
j \in U(x^{k_i},y^{k_i}) \cup C(x^{k_i},y^{k_i})\\
\end{aligned}
\end{equation}
and:
\begin{equation}\label{eq:direction1}
\begin{aligned}
 \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i^*}} &\le \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i}}\\
 \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{i^*}} &\ge \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{j}}
 \end{aligned}
\end{equation}

Because of  definition of $K_1$ we can say that:
\begin{equation}
 \lim_{k_i \in K_1, k_i \rightarrow \infty} x^{k_i} =\overline{x}
\end{equation}
Quadratic line search guarantees that:
\begin{equation}
 ||x^{k+2n}-x^{k}|| \rightarrow 0
\end{equation}


Hence because of $p(k_i)-k_i \le 2n$ we have:
\begin{equation}
 \lim_{k_i \in K_1,k_i\rightarrow \infty}  ||x^{p(k_i)}-x^{k_i}||=0
\end{equation}
Then:
\begin{equation}
 \lim_{k_i \in K_1,k_i\rightarrow \infty} x^{p(k_i)}=\overline{x}
\end{equation}




At limit point $\overline{x}$, from equation (\ref{eq:direction1})  we have: 
\begin{equation*}
 \frac{\partial f(\overline{x},\overline{y})}{dx_i} - \frac{\partial f(\overline{x},\overline{y})}{dx_{j}} \ge 0
\end{equation*}




which contradicts \ref{eq:b}.

\end{proof}
\fi
 %%%%NEW DIM%%%%
%\begin{proof}
 Let's suppose that every $M \in \mathbb{N}$ iterations we select the Most-Violating-Pair and in other iteration we select simply a violating pair.
 
 Let's consider the subsequence $x^{k}$ with $k  \in K =\{0,M,2M,\ldots\}$ in which we take the MVP.
 In next iterations $k+m \in K$, $m\ge 0$ we have at least one of these two possible cases, from MVP selection rule:

 
 \begin{subequations}
\begin{align}
 j(k+m) &\in L(x^{k+m+1})\label{eq:SetCasesA}\\
 i(k+m) &\in U(x^{k+m+1})\label{eq:SetCasesB}
\end{align}
\end{subequations}
 
 
 
Now we define two sets $\Gamma_1,\Gamma_2$ in $\{x^{k}\}_{k \in K}$ such that the first one contains all indexes $m \in\{0,\ldots,2n\}$ such that \ref{eq:SetCasesA} hold.
On the contrary the second one contains all indexes $m \in\{0,\ldots,2n\}$ such that (\ref{eq:SetCasesB}) hold.

Because of $|\Gamma_1|+|\Gamma_2|\ge2n+1$, one of these set have more than $n$ elements. Without loss of generality we take $|\Gamma_1|> n$.
 We can say that $\exists i^* \in \{1,\ldots,n\}$ and $l(k),m(k)$ such that:
 \begin{equation}
  k\le l(k) <m(k)\le2 n
 \end{equation}
and:
\begin{equation}
 i(k) = i(l(k))=i(m(k))=i^*
\end{equation}

We can define a subset $K_1 \subseteq K$ such that $\forall k_i \in K_1$ holds:
\begin{equation}
 i(k_i)=i^*
\end{equation}
and:
\begin{equation}
 k_i <k_{i+1} \le k_i+2n
\end{equation}


For the MVP selection rule $\forall k_i \in K_1$ must hold:
\begin{equation}
 \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i^*}} \le \frac{\partial f(x^{k_i},y^{k_i})}{dx_{h}}, \ \forall h \in L(x^{k_i}) \cup C(x^{k_i})
\end{equation}

But  $\forall k_i \in K_1,\exists p(k_i)$ with  $k_i <p(k_i)<k_{i+1}$ such that:
\begin{equation}
 i^* \not \in U(x^{p(k_i)+1})
\end{equation}
and then
\begin{equation}
 \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{i^*}} \ge \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{h}}, \ \forall h \in U(x^{p(k_i)}) \cup C(x^{p(k_i)})
\end{equation}


Thanks to Lemma (\ref{lem:direction}) we can say that for $k$ sufficiently large, the set of feasible direction in $(x^k,y^k)$ contains the correspondent set in $(\overline{x},\overline{y})$.

Then for $k_i \in K_2 \subset K_1$, $k_i$ sufficiently large, then following (\ref{eq:b}) we have:
\begin{equation}
\begin{aligned}
i \in L(x^{k_i},y^{k_i}) \cup C(x^{k_i},y^{k_i})\\
j \in U(x^{k_i},y^{k_i}) \cup C(x^{k_i},y^{k_i})\\
\end{aligned}
\end{equation}
and:
\begin{equation}\label{eq:direction1}
\begin{aligned}
 \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i^*}} &\le \frac{\partial f(x^{k_i},y^{k_i})}{dx_{i}}\\
 \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{i^*}} &\ge \frac{\partial f(x^{p(k_i)},y^{p(k_i)})}{dx_{j}}
 \end{aligned}
\end{equation}

Because of  definition of $K_2$ we can say that:
\begin{equation}
 \lim_{k_i \in K_2, k_i \rightarrow \infty} x^{k_i} =\overline{x}
\end{equation}
Quadratic line search guarantees that:
\begin{equation}
 ||x^{k+2n}-x^{k}|| \rightarrow 0
\end{equation}


Hence because of $p(k_i)-k_i \le 2n$ we have:
\begin{equation}
 \lim_{k_i \in K_2,k_i\rightarrow \infty}  ||x^{p(k_i)}-x^{k_i}||=0
\end{equation}
Then:
\begin{equation}
 \lim_{k_i \in K_2,k_i\rightarrow \infty} x^{p(k_i)}=\overline{x}
\end{equation}

At limit point $\overline{x}$, from equation (\ref{eq:direction1})  we have: 
\begin{equation*}
 \frac{\partial f(\overline{x},\overline{y})}{dx_i} - \frac{\partial f(\overline{x},\overline{y})}{dx_{j}} \ge 0
\end{equation*}

which contradicts (\ref{eq:b}).
\end{proof}

\begin{proposition}
Suppose that the level set $\mathcal{L}_0$ is a compact set. Let $\{(x^k, y^k)\}$ be the sequence of points generated by the decomposition algorithm with proximal point modification. Then
\begin{itemize}
\item $(x^k, y^k) \in \mathcal{L}_0, \enskip \forall k$ 
\item  $\{(x^k, y^k)\}$ admits limit points and each limit point is critical for Problem (\ref{eq:problem})
\end{itemize}
\end{proposition}
\begin{proof}
The firts assertion is given by algorithm statement which say:
\begin{equation}
f(x^{k+1},y^{k+1})\le f(x^{k+1},y^k)\le f(x^k,y^k)- \underbrace{\frac{1}{2}\tau ||x^{k+1}-x^{k}||^2}_{>0}
\end{equation}
then the sequence $\{(x^k,y^k)\} \in \mathcal{L}_0$.

To prove the second assertion it is necessary to show that
\begin{equation}
\lim_{k \rightarrow \infty} ||x^{k+1}-x^{k}||=0
\end{equation}
then the convergence can be completed as in previous proposition.


From the $\mathcal{L}_0$ compactness we can say that the sequence $\{(x^k,y^k)\}$ has a subsequence $K \subset \{0,1,\ldots\}$ convergent to $(\overline{x},\overline{y}) \in \mathcal{L}_0$. Then for the continuity of $f$ we have:
\begin{equation}
\lim_{k \in K, k \rightarrow \infty}f(x^k,y^k)=f(\overline{x},\overline{y})= \overline{f}
\end{equation}

The instruction of algorithm imply that:
\begin{equation}
f(x^{k+1},y^{k+1})\le f(x^{k+1},y^{k})\le f(x^k,y^k)
\end{equation}
then the sequence $f(x^k,y^k)$ is decreasing and lower-bounded by $\overline{f}$ then we have:
\begin{equation}
\lim_{k \in K, k \rightarrow \infty} f(x^{k+1},y^{k})-f(x^{k},y^{k})=0
\end{equation}

Proximal point step imply that:
\begin{equation}
f(x^{k+1},y^{k})+\frac{1}{2}\tau||x^{k+1}-x^{k}||^2 \le f(x^{k},y^{k})
\end{equation}

Taking the limit for $k \in K, k \rightarrow \infty$ we obtain:
\begin{equation}
\lim_{k in K, \rightarrow \infty} ||x^{k+1}-x^{k}||=0
\end{equation}

Next convergence steps are equal to previous proposition.
\end{proof}

\begin{oss}
In computational experiments we use $\tau = 0$ and compute an exact line search along direction $d^{i(k),j(k)}$. In next section we will show that in practical cases exact line search performs very well especially increasing number of variables.
\end{oss}
